subscription GetDocument($documentID: uuid!) {
  document: documents_by_pk(id: $documentID) {
    id
    prompt
    title
    is_public
    template
    metadata
    summary
    guidance(order_by: { created_at: asc, prompt: asc }) {
      id
      is_enabled
      prompt
      type
    }
    blocks(order_by: { index: asc, created_at: desc }) {
      id
      prompt
      created_at
      output
      metadata
      status
      index
      type
      is_manual_overwrite
      guidance_aggregate(
        where: { is_enabled: { _eq: true }, type: { _eq: "CUSTOM" } }
      ) {
        aggregate {
          count
        }
      }
    }
  }
}
