table:
  name: donors
  schema: public
object_relationships:
  - name: portfolio
    using:
      manual_configuration:
        column_mapping:
          portfolio_id: id
        insertion_order: null
        remote_table:
          name: portfolios
          schema: public
array_relationships:
  - name: notes
    using:
      manual_configuration:
        column_mapping:
          id: donor_id
        insertion_order: null
        remote_table:
          name: notes
          schema: public
remote_relationships:
  - definition:
      to_remote_schema:
        lhs_fields:
          - crm_id
        remote_field:
          CRMDonor:
            arguments:
              id: $crm_id
        remote_schema: crm
    name: crm
insert_permissions:
  - role: user
    permission:
      check:
        portfolio:
          org:
            members:
              user_id:
                _eq: X-Hasura-User-Id
      columns:
        - touches
        - crm_id
        - id
        - portfolio_id
select_permissions:
  - role: user
    permission:
      columns:
        - crm_id
        - id
        - portfolio_id
        - touches
      filter:
        portfolio:
          org:
            members:
              user_id:
                _eq: X-Hasura-User-Id
      allow_aggregations: true
update_permissions:
  - role: user
    permission:
      columns:
        - touches
      filter:
        portfolio:
          org:
            members:
              user_id:
                _eq: X-Hasura-User-Id
      check:
        portfolio:
          org:
            members:
              user_id:
                _eq: X-Hasura-User-Id
